function RMsReader_MCAL , FILE_NAME_RMs

;**********************************************************************************
; Define column names for only MCAL RMs
;**********************************************************************************

col=['TIME',$
'SC3540_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3541_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3542_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3543_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3544_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3545_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3546_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3547_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3548_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3549_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3550_0_MCAL1_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3551_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3552_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3553_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3554_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3555_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3556_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3557_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3558_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3559_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3560_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3561_0_MCAL1_RAT_PLANE_Z_ENERGY_CHAN_11 ',$
'SC3562_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3563_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3564_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3565_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3566_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3567_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3568_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3569_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3570_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3571_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3572_0_MCAL2_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3573_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3574_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3575_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3576_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3577_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3578_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3579_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3580_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3581_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3582_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3583_0_MCAL2_RAT_PLANE_Z_ENERGY_CHAN_11 ',$
'SC3584_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3585_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3586_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3587_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3588_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3589_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3590_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3591_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3592_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3593_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3594_0_MCAL3_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3595_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3596_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3597_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3598_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3599_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3600_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3601_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3602_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3603_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3604_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3605_0_MCAL3_RAT_PLANE_Z_ENERGY_CHAN_11 ',$
'SC3606_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3607_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3608_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3609_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3610_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3611_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3612_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3613_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3614_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3615_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3616_0_MCAL4_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3617_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3618_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3619_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3620_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3621_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3622_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3623_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3624_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3625_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3626_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3627_0_MCAL4_RAT_PLANE_Z_ENERGY_CHAN_11 ',$
'SC3628_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3629_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3630_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3631_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3632_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3633_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3634_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3635_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3636_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3637_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3638_0_MCAL5_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3639_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3640_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3641_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3642_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3643_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3644_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3645_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3646_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3647_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3648_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3649_0_MCAL5_RAT_PLANE_Z_ENERGY_CHAN_11 ',$
'SC3650_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3651_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3652_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3653_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3654_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3655_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3656_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3657_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3658_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3659_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3660_0_MCAL6_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3661_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3662_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3663_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3664_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3665_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3666_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3667_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3668_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3669_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3670_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3671_0_MCAL6_RAT_PLANE_Z_ENERGY_CHAN_11 ',$
'SC3672_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3673_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3674_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3675_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3676_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3677_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3678_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3679_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3680_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3681_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3682_0_MCAL7_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3683_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3684_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3685_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3686_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3687_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3688_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3689_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3690_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3691_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3692_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3693_0_MCAL7_RAT_PLANE_Z_ENERGY_CHAN_11 ',$
'SC3694_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_1  ',$
'SC3695_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_2  ',$
'SC3696_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_3  ',$
'SC3697_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_4  ',$
'SC3698_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_5  ',$
'SC3699_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_6  ',$
'SC3700_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_7  ',$
'SC3701_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_8  ',$
'SC3702_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_9  ',$
'SC3703_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_10 ',$
'SC3704_0_MCAL8_RAT_PLANE_X_ENERGY_CHAN_11 ',$
'SC3705_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_1  ',$
'SC3706_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_2  ',$
'SC3707_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_3  ',$
'SC3708_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_4  ',$
'SC3709_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_5  ',$
'SC3710_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_6  ',$
'SC3711_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_7  ',$
'SC3712_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_8  ',$
'SC3713_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_9  ',$
'SC3714_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_10 ',$
'SC3715_0_MCAL8_RAT_PLANE_Z_ENERGY_CHAN_11 ']

col=strcompress(col,/remove_all)
wait,0.001
;print,format='(/,"Start reading RMs",/)'
a=mrdfits(FILE_NAME_RMs(0),1,h,columns=col,/fscale)
n=tag_names(a)

;**********************************************************************************
; Compose RMs in standard format columns
;**********************************************************************************

RMss=uintarr(22,n_elements(a.(161))*8)
aproX=intarr(n_elements(a.(161)),8)
aproZ=intarr(n_elements(a.(161)),8)
inc=[7.16800,6.14400,5.12000,4.09600,3.07200,2.04800,1.02400,0.000000]
;inc=[0.000000,1024.00,2048.00,3072.00,4096.00,5120.00,6144.00,7168.00]
time=dblarr(n_elements(a.(161)),8)
for k=1,11 do begin
	Nchan=strcompress(string(k),/remove_all)
	for i=1,8 do begin
		Nsec=strcompress(string(i),/remove_all)
		RMs_name=STRUPCASE('_0_MCAL'+Nsec+'_Rat_Plane_X_Energy_Chan_'+Nchan)
		ind=where(strpos(n, RMs_name) ne -1,c)
		aproX(*,i-1)=a.(ind(0))
		RMs_name=STRUPCASE('_0_MCAL'+Nsec+'_Rat_Plane_Z_Energy_Chan_'+Nchan)
		ind=where(strpos(n, RMs_name) ne -1,c)
		aproZ(*,i-1)=a.(ind(0))
		;time_single(k)=(a.time(k)/1000.0d)-inc(i))/1000.0d
	endfor
	RMss(k-1,*)=transpose(aprox(*,*))
	RMss(k+10,*)=transpose(aproz(*,*))
endfor

for j=0,7 do time(*,j)=a.time-inc(j mod 8)

;RMs = {X : RMss (0:10,*) , Z : RMss (11:21,*) , TIME : reform(transpose(time),n_elements(time))}
RMs = [transpose(reform(transpose(time),n_elements(time))) , RMss (0:10,*) , RMss (11:21,*)]
wait,0.001
;print,format='(/,"RMs ready",/)'

start=h(where(strpos(H,'TSTART') ne -1))
start_arr=strsplit(start,' ',/extract)
TSTART=double(start_arr(2))
stop=h(where(strpos(H,'TSTOP') ne -1))
stop_arr=strsplit(stop,' ',/extract)
TSTOP=double(stop_arr(2))
RMs={Data : RMs , Time : [TSTART,TSTOP]}
;print,start,stop
;stop
;RMs={Data: RMs , Time : }
;help,rms,/str
return,RMs
;return,h
end